{% extends "base.html" %}

{% block title %}Danh sách sản phẩm{% endblock %}
{% block main_heading %}Danh Sách Sản Phẩm ({{ products|length }} món){% endblock %}

{% block content %}
<div class="card" style="max-width: 90%; margin: 0 auto;">
    <!-- Form Tìm kiếm -->
    <form method="GET" action="{{ url_for('products') }}" style="margin-bottom: 30px; display: flex; gap: 10px;">
        <input type="text" name="keyword" value="{{ keyword or '' }}" placeholder="Nhập tên sản phẩm để tìm kiếm..."
               style="flex-grow: 1; border-radius: 6px;">
        <button type="submit" style="background-color: #3498db; padding: 10px 20px;">
            Tìm kiếm
        </button>
    </form>

    {% if products|length == 0 %}
        <div style="background-color: #fef3c7; border: 1px solid #f59e0b; color: #b45309; padding: 15px; border-radius: 8px; text-align: center; font-weight: 600;">
            <p style="margin: 0;">⚠️ Không tìm thấy sản phẩm nào {% if keyword %}với từ khóa "{{ keyword }}"{% endif %}.</p>
        </div>
    {% else %}
        <!-- Bảng Sản phẩm -->
        <table>
              <thead>
                <tr>
                  <th style="width: 5%;">ID</th>
                  <th style="width: 30%;">Tên sản phẩm</th>
                  <th style="width: 15%;">Giá</th>
                  <th style="width: 40%;">Mô tả</th>
                  <th style="width: 10%;">Hành động</th>
                </tr>
              </thead>
              <tbody>
                {% for p in products %}
                <tr>
                  <td style="font-weight: 700;">{{ p.id }}</td>
                  <td>{{ p.name }}</td>
                  <td style="color: #27ae60; font-weight: bold;">{{ "{:,.0f}".format(p.price) }} đ</td>
                  <td style="font-size: 0.95em; color: #555;">{{ p.description }}</td>
                  <td>
                      <a href="{{ url_for('detail', product_id=p.id) }}" style="color: #3498db; text-decoration: none; font-weight: 600; transition: color 0.2s;">
                          Chi tiết &rarr;
                      </a>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
        </table>
    {% endif %}
</div>
{% endblock %}